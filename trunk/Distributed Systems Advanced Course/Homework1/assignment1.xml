<?xml version="1.0" encoding="UTF-8"?>
<tns:configuration xmlns:tns="http://www.sics.se/adl">
    <tns:factories>
        <tns:factory>
            <tns:factoryName>ApplicationFactory</tns:factoryName>
            <tns:componentClass>assignment1.components.ApplicationComponent</tns:componentClass>
        </tns:factory>
        <tns:factory>
            <tns:factoryName>FloodFactory</tns:factoryName>
            <tns:componentClass>assignment1.components.FloodComponent</tns:componentClass>
        </tns:factory>
        <tns:factory>
            <tns:factoryName>DropFactory</tns:factoryName>
            <tns:componentClass>assignment1.components.DropComponent</tns:componentClass>
        </tns:factory>
        <tns:factory>
            <tns:factoryName>DelayFactory</tns:factoryName>
            <tns:componentClass>assignment1.components.DelayComponent</tns:componentClass>
        </tns:factory>
        <tns:factory>
            <tns:factoryName>TimerFactory</tns:factoryName>
            <tns:componentClass>tbn.timer.TimerComponent</tns:componentClass>
        </tns:factory>
        <tns:factory>
            <tns:factoryName>CommunicationFactory</tns:factoryName>
            <tns:componentClass>tbn.comm.mina.CommunicationComponent</tns:componentClass>
        </tns:factory>
    </tns:factories>

    <tns:components>
        <tns:component>
            <tns:factoryName>ApplicationFactory</tns:factoryName>
            <tns:componentName>Application</tns:componentName>
        </tns:component>
        <tns:component>
            <tns:factoryName>FloodFactory</tns:factoryName>
            <tns:componentName>Flood</tns:componentName>
        </tns:component>
        <tns:component>
            <tns:factoryName>DropFactory</tns:factoryName>
            <tns:componentName>Drop</tns:componentName>
        </tns:component>
        <tns:component>
            <tns:factoryName>DelayFactory</tns:factoryName>
            <tns:componentName>Delay</tns:componentName>
        </tns:component>
        <tns:component>
            <tns:factoryName>TimerFactory</tns:factoryName>
            <tns:componentName>Timer</tns:componentName>
        </tns:component>
        <tns:component>
            <tns:factoryName>CommunicationFactory</tns:factoryName>
            <tns:componentName>Communication</tns:componentName>
        </tns:component>
    </tns:components>

    <tns:channels>
        <tns:channel>
            <tns:channelName>FloodEventChannel</tns:channelName>
            <tns:eventClass>assignment1.events.FloodInitEvent</tns:eventClass>
            <tns:eventClass>assignment1.events.FloodDoneEvent</tns:eventClass>
        </tns:channel>
        <tns:channel>
            <tns:channelName>FloodMessageChannel</tns:channelName>
            <tns:eventClass>assignment1.events.FloodMessage</tns:eventClass>
        </tns:channel>
        <tns:channel>
            <tns:channelName>DropMessageChannel</tns:channelName>
            <tns:eventClass>tbn.comm.mina.events.MessageEvent</tns:eventClass>
        </tns:channel>
        <tns:channel>
            <tns:channelName>InitEventChannel</tns:channelName>
            <tns:eventClass>assignment1.events.InitEvent</tns:eventClass>
        </tns:channel>
        <tns:channel>
            <tns:channelName>DelayMessageChannel</tns:channelName>
            <tns:eventClass>tbn.comm.mina.events.MessageEvent</tns:eventClass>
        </tns:channel>
        <tns:channel>
            <tns:channelName>TimerMessageChannel</tns:channelName>
            <tns:eventClass>tbn.timer.events.TimerEvent</tns:eventClass>
        </tns:channel>
        <tns:channel>
            <tns:channelName>SendMessageChannel</tns:channelName>
            <tns:eventClass>tbn.comm.mina.events.MessageEvent</tns:eventClass>
        </tns:channel>
        <tns:channel>
            <tns:channelName>DelayTimerExpiredEventChannel</tns:channelName>
            <tns:eventClass>assignment1.events.DelayTimerExpiredEvent</tns:eventClass>
        </tns:channel>
    </tns:channels>
    <!--bind component's output event to channel-->
    <tns:bindings>
        <tns:binding>
            <tns:componentName>ApplicationFactory:Application</tns:componentName>
            <tns:eventClass>assignment1.events.InitEvent</tns:eventClass>
            <tns:channelName>InitEventChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>ApplicationFactory:Application</tns:componentName>
            <tns:eventClass>assignment1.events.FloodInitEvent</tns:eventClass>
            <tns:channelName>FloodEventChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>FloodFactory:Flood</tns:componentName>
            <tns:eventClass>assignment1.events.FloodDoneEvent</tns:eventClass>
            <tns:channelName>FloodEventChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>FloodFactory:Flood</tns:componentName>
            <tns:eventClass>tbn.comm.mina.events.MessageEvent</tns:eventClass>
            <tns:channelName>DropMessageChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>DropFactory:Drop</tns:componentName>
            <tns:eventClass>tbn.comm.mina.events.MessageEvent</tns:eventClass>
            <tns:channelName>DelayMessageChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>DelayFactory:Delay</tns:componentName>
            <tns:eventClass>tbn.timer.events.TimerEvent</tns:eventClass>
            <tns:channelName>TimerEventChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>DelayFactory:Delay</tns:componentName>
            <tns:eventClass>tbn.comm.mina.events.MessageEvent</tns:eventClass>
            <tns:channelName>SendMessageChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>TimerFactory:Timer</tns:componentName>
            <tns:eventClass>assignment1.events.DelayTimerExpiredEvent</tns:eventClass>
            <tns:channelName>DelayTimerExpireChannel</tns:channelName>
        </tns:binding>
        <tns:binding>
            <tns:componentName>CommunicationFactory:Communication</tns:componentName>
            <tns:eventClass>assignment1.events.FloodMessage</tns:eventClass>
            <tns:channelName>FloodMessageChannel</tns:channelName>
        </tns:binding>
    </tns:bindings>
    <!--subscribe a channel to linsen and with the component's handler to handle the incoming messages-->
    <tns:subscriptions>
        <tns:subscription>
            <tns:componentName>ApplicationFactory:Application</tns:componentName>
            <tns:channelName>FloodEventChannel</tns:channelName>
            <tns:handlerName>handleFloodDoneEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>FloodFactory:Flood</tns:componentName>
            <tns:channelName>FloodEventChannel</tns:channelName>
            <tns:handlerName>handleFloodInitEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>FloodFactory:Flood</tns:componentName>
            <tns:channelName>FloodMessageChannel</tns:channelName>
            <tns:handlerName>handleFloodMessage</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>FloodFactory:Flood</tns:componentName>
            <tns:channelName>InitEventChannel</tns:channelName>
            <tns:handlerName>handleInitEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>DropFactory:Drop</tns:componentName>
            <tns:channelName>InitEventChannel</tns:channelName>
            <tns:handlerName>handleInitEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>DropFactory:Drop</tns:componentName>
            <tns:channelName>DropMessageChannel</tns:channelName>
            <tns:handlerName>handleMessageEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>DelayFactory:Delay</tns:componentName>
            <tns:channelName>InitEventChannel</tns:channelName>
            <tns:handlerName>handleInitEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>DelayFactory:Delay</tns:componentName>
            <tns:channelName>DelayMessageChannel</tns:channelName>
            <tns:handlerName>handleMessageEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>DelayFactory:Delay</tns:componentName>
            <tns:channelName>DelayTimerExpiredEventChannel</tns:channelName>
            <tns:handlerName>handleDelayTimerExpiredEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>TimerFactory:Timer</tns:componentName>
            <tns:channelName>TimerEventChannel</tns:channelName>
            <tns:handlerName>handleTimerEvent</tns:handlerName>
        </tns:subscription>
        <tns:subscription>
            <tns:componentName>CommunicationFactory:Communication</tns:componentName>
            <tns:channelName>SendMessageChannel</tns:channelName>
            <tns:handlerName>handleMessageEvent</tns:handlerName>
        </tns:subscription>
    </tns:subscriptions>
    <!--//////////////////////////////////////////////////////////////////////////-->
    <!--////////////////remember to start the initial component last//////////////-->
    <!--//////////////////////////////////////////////////////////////////////////-->
    <tns:startSequence>
        <tns:startComponents>
            <tns:componentName>ApplicationFactory:Application</tns:componentName>
            <tns:componentName>FloodFactory:Flood</tns:componentName>
            <tns:componentName>DropFactory:Drop</tns:componentName>
            <tns:componentName>DelayFactory:Delay</tns:componentName>
            <tns:componentName>TimerFactory:Timer</tns:componentName>
            <tns:componentName>CommunicationFactory:Communication</tns:componentName>
        </tns:startComponents>
        <tns:startChannels>
            <tns:channelName>InitEventChannel</tns:channelName>
            <tns:channelName>FloodEventChannel</tns:channelName>
            <tns:channelName>DropMessageChannel</tns:channelName>
            <tns:channelName>DelayMessageChannel</tns:channelName>
            <tns:channelName>TimerEventChannel</tns:channelName>
            <tns:channelName>DelayTimerExpiredEventChannel</tns:channelName>
            <tns:channelName>SendMessageChannel</tns:channelName>
            <tns:channelName>FloodMessageChannel</tns:channelName>
        </tns:startChannels>
    </tns:startSequence>

</tns:configuration>

